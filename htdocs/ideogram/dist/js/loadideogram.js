var config = { 
	organism: "dummy",
	orientation: "horizontal",
	ploidy: 2, 
	ploidysize: 11,
	anotcolor: ["#D85B27", "#8CA352","#E9E8EE"],
	chrMargin: 0, 
	ancestors: {
		"A": "#dea673",
		"B": "#7396be",
		"C": "#272727",
		"D": "#437343",
		"E": "#737373",
		"F": "#487646",
		"H": "#D3H4A2"
	},
	ploidyDesc: [],
	rangeSet: []
};
var chrBands = [];
var preset1 = {
	A : "#BBBBBB",
	B : "#7396be",
	C : "#EADED7",
	D : "#91605A",
	E : "#EADED7",
	F : "",
	G : "",
	H : "",
	ploidy : "#6AC776"
};
var preset2 = {
	A : "#F1EDE7",
	B : "#8C8176",
	C : "#BC8751",
	D : "#B1BB8F",
	E : "#F06053",
	F : "",
	G : "",
	H : "",
	ploidy : "#485150"
}
var preset3 = {
	A : "#D9ABB5",
	B : "#C29BB6",
	C : "#242025",
	D : "#C0A58A",
	E : "#EADED7",
	F : "",
	G : "",
	H : "",
	ploidy : "#4A2D89"
};

function initploidydesc(){
	switch(config.ploidy) {
		case "2":
		var ploidytext="AA";
		break;
		case "3":
		var ploidytext="AAA";
		break;
		case "4":
		var ploidytext="AAAA";
		break;
		case 2:
		var ploidytext="AA";
		break;
		case 3:
		var ploidytext="AAA";
		break;
		case 4:
		var ploidytext="AAAA";
		break;
	}
	config.ploidyDesc = [];
	for (var i = 0; i < config.ploidysize; i++) {
		config.ploidyDesc.push(ploidytext);
	}
}
function chromosomeParser(data){
	chrBands=[];
	var split = data.split("\n");
	var localsplit  = "";
	var data = "";
	var localchr="";
	config.ploidysize = split.length;
	for (var i = 0; i < split.length; i++) {
		localsplit = split[i].split(" ");
    	//LocalSplit[0] = chromosome choisi, localsplit[1] = longeur du chromosome
    	localchr = localsplit[0]+" p 1 0 "+(localsplit[1]/2)+" 0 "+(localsplit[1]/2);
    	chrBands.push(localchr);
    	localchr = localsplit[0]+" p 1 0 "+(localsplit[1]/2)+" "+(localsplit[1]/2)+" "+localsplit[1];
    	chrBands.push(localchr);
    }
}
function annotationParser(data){
	var split = data.split("\n");
	var localsplit  = "";
	var data = "";
	var localannot="";
	var ploidy=[];

	config.rangeSet = [];
	for (var i = 0; i < split.length; i++) {
		ploidy = [];
		localsplit = split[i].split(" ");
		//Boucle qui sert a dÃ©finir la position de l'annotation
		for(var n = 0; n< config.ploidy; n++){
			if(n == parseInt(localsplit[1])){
				ploidy.push(1);
			}else {
				ploidy.push(0);
			}
		}
		chromosome = {
			chr: localsplit[0],
			ploidy: ploidy,
			start: localsplit[2],
			stop: localsplit[3],
			color: config.anotcolor[localsplit[4]]
		};
		config.rangeSet.push(chromosome);
	}
}
function updateploidy(value){
	console.log(value)
	config.ploidy = value;
	load_ideogram();
}
function load_ideogram(){
	clear();
	var chrdata = $("#editorChr").val();
	var annotdata = $("#editorAnnot").val();
	chromosomeParser(chrdata);
	annotationParser(annotdata);
	initploidydesc();
	if(chrdata != ""){
		var ideogram = new Ideogram(config);
	}
	$('#download').fadeIn()
	repositione();
	$('#potatosalad').on('click', function(event){
    //The event won't be propagated to the document NODE and 
    // therefore events delegated to document won't be fired
    event.stopPropagation();
});
}
function load_file(){
	$("#fileInput").show();
	colorpreset();
	var fileInput = document.getElementById('fileInput');
	fileInput.addEventListener('change', function(e) {
		var file = fileInput.files[0];
		var reader = new FileReader();
		reader.onload = function(e) {

			$("#editorChr").text(reader.result);
			$("#fileInput").hide();
		};
		reader.readAsText(file);  
	});   
}
function repositione(){
	setTimeout(function(){
		var ideo = document.getElementById("_ideogram");
		var tideo = document.getElementById("targetideo");
		tideo.appendChild(ideo);
	}, 50);
}
function load_test(){
	$("#editorChr").text("1 29070452\n2 29511734\n3 35020413\n4 37105743\n5 41853232\n6 37593364\n7 35028021\n8 44889171\n9 41306725\n10 37674811\n11 27954350");
	$("#editorAnnot").text("1 0 1 684971 1\n1 0 685061 845377 2\n1 0 845500 943540 1\n1 0 944239 945341 2\n1 0 945371 945410 1\n1 0 945532 975640 2\n1 0 975643 975675 1\n1 0 975738 1161899 2\n1 0 1161947 1202347 1\n1 0 1202387 1203004 2\n1 0 1203071 1203467 1\n1 0 1203563 1203563 2\n1 0 1203566 3746681 1\n1 0 3747053 4463896 2\n1 0 4467156 5532893 1\n1 0 5532953 5541983 2\n1 0 5542122 5796025 1\n1 0 5796168 5892640 2\n1 0 5892753 5896155 1\n1 0 5900174 6153223 2\n1 0 6153241 6155559 1\n1 0 6155642 6172858 2\n1 0 6180093 6180275 1\n1 0 6180379 6180457 2\n1 0 6180544 6180937 1\n1 0 6193874 6193938 2\n1 0 6194128 6194128 1\n1 0 6194240 6202410 2\n1 0 6202505 6277493 1\n1 0 6278464 6310361 2\n1 0 6310488 6388874 1\n1 0 6388895 6388895 2\n1 0 6388966 6388966 1\n1 0 6389700 6708072 2\n1 0 6708125 6708746 1\n1 0 6708778 6863062 2\n1 0 6863275 6869945 1\n1 0 6870062 6870062 2\n1 0 6870156 7633822 1\n1 0 7633830 7634067 2\n1 0 7634130 7634130 1\n1 0 7655187 7676058 2\n1 0 7676068 7679511 1\n1 0 7683323 8035909 2\n1 0 8035948 8036689 1\n1 0 8036701 8036701 2\n1 0 8036784 8036849 1\n1 0 8036878 8043645 2\n1 0 8045426 8045426 1\n1 0 8045481 8045481 2\n1 0 8047158 8047323 1\n1 0 8047550 8047550 2\n1 0 8047556 8047556 1\n1 0 8048836 10270019 2\n1 0 10270052 10270591 1\n1 0 10270634 10276958 2\n1 0 10277206 10303013 1\n1 0 10307704 10308510 2\n1 0 10309035 10312133 1\n1 0 10312225 10314796 2\n1 0 10314860 10444799 1\n1 0 10444832 10446126 2\n1 0 10446144 10446307 1\n1 0 10446327 10446429 2\n1 0 10446435 10607801 1\n1 0 10651852 10652180 2\n1 0 10652992 10653201 1\n1 0 10653221 10654166 2\n1 0 10656057 10656111 1\n1 0 10656129 10701696 2\n1 0 10701700 10703587 1\n1 0 10703594 10869874 2\n1 0 10869880 10901868 1\n1 0 10923911 10936634 2\n1 0 10936644 10936665 1\n1 0 10936691 10952622 2\n1 0 10952628 11856459 1\n1 0 11856474 12501788 2\n1 0 12504020 12504020 1\n1 0 12504083 12512189 2\n1 0 12512192 12512426 1\n1 0 12537323 12539607 2\n1 0 12539611 12768675 1\n1 0 12768724 12795453 2\n1 0 12798475 12833618 1\n1 0 12833631 12858741 2\n1 0 12863127 13217524 1\n1 0 13217540 14261316 2\n1 0 14261324 14261520 1\n1 0 14261555 14261555 2\n1 0 14261564 23318267 1\n1 0 23318281 23318292 2\n1 0 23318302 23324591 1\n1 0 23324619 29070452 2\n2 0 1 20232397 3\n2 0 20232421 20408276 2\n2 0 20408297 27819366 3\n2 0 27819370 27819370 2\n2 0 27819566 27819566 3\n2 0 27820666 27859680 2\n2 0 27860160 28115651 3\n2 0 28115659 28116125 2\n2 0 28116350 29511734 3\n3 0 1 3515060 4\n3 0 3515079 3558116 2\n3 0 3559961 3560136 4\n3 0 3560151 3564283 2\n3 0 3565852 3922225 4\n3 0 3922246 3926253 2\n3 0 3926859 6079828 4\n3 0 6079840 6651166 2\n3 0 6651206 28172122 4\n3 0 28172179 28197428 2\n3 0 28198798 28198821 4\n3 0 28199206 28199206 2\n3 0 28199494 28199787 4\n3 0 28199833 28199982 2\n3 0 28211092 28236406 4\n3 0 28236549 28236549 2\n3 0 28236585 28236585 4\n3 0 28236788 28471274 2\n3 0 28471277 28482770 4\n3 0 28482797 28510221 2\n3 0 28510229 30336225 4\n3 0 30336233 30337644 2\n3 0 30337664 30343620 4\n3 0 30344044 30505058 2\n3 0 30505138 33396766 4\n3 0 33396862 33396862 2\n3 0 33396876 33397841 4\n3 0 33397892 33658992 2\n3 0 33659202 33726328 4\n3 0 33726341 33726373 2\n3 0 33726493 33726493 4\n3 0 33726526 33726526 2\n3 0 33726667 33726757 4\n3 0 33726796 33726796 2\n3 0 33726811 33806211 4\n3 0 33806441 33810515 2\n3 0 33810640 35020413 4\n4 0 1 2474979 3\n4 0 2475003 3089885 2\n4 0 3090584 3650168 3\n4 0 3650174 3747520 2\n4 0 3748045 4872301 4\n4 0 4872378 4872378 2\n4 0 4873089 6300650 4\n4 0 6301851 6301872 2\n4 0 6303616 15237102 4\n4 0 15237140 15237348 2\n4 0 15237374 17409071 4\n4 0 17429147 17789902 2\n4 0 17789933 17790234 4\n4 0 17790289 17790841 2\n4 0 17790882 17790882 4\n4 0 17804345 18009938 2\n4 0 18010310 22146842 4\n4 0 22146856 22150469 2\n4 0 22150480 22150480 4\n4 0 22150669 22174539 2\n4 0 22174712 22174767 4\n4 0 22174839 22174839 2\n4 0 22174859 22260657 4\n4 0 22260673 22260694 2\n4 0 22260703 22260857 4\n4 0 22356702 22357008 2\n4 0 22361009 24453632 4\n4 0 24453647 24475984 2\n4 0 24475990 24652855 4\n4 0 24652905 24652920 2\n4 0 24652959 24746868 4\n4 0 24746880 24752456 2\n4 0 24752517 24762914 4\n4 0 24764857 24765049 2\n4 0 24765263 24797655 4\n4 0 24797986 24798174 2\n4 0 24798333 24798333 4\n4 0 24798338 24841572 2\n4 0 24841599 24841689 4\n4 0 24841712 24875849 2\n4 0 24875957 24876128 4\n4 0 24876134 24887945 2\n4 0 24887960 24887990 4\n4 0 24888232 24888232 2\n4 0 24888869 24888978 4\n4 0 24888996 24889011 2\n4 0 24889151 24907175 4\n4 0 24907213 24908873 2\n4 0 24908972 24911783 4\n4 0 24911834 24912017 2\n4 0 24912157 25017548 4\n4 0 25018778 25270668 2\n4 0 25270695 25271091 4\n4 0 25271301 26046804 2\n4 0 26046808 27488301 3\n4 0 27509400 27509411 2\n4 0 27509442 27510658 3\n4 0 27510755 27653285 2\n4 0 27653346 27732930 4\n4 0 27735165 27826191 2\n4 0 27827269 27844822 4\n4 0 27845770 27845770 2\n4 0 27845945 27845945 4\n4 0 27845965 27850684 2\n4 0 27850752 27903277 4\n4 0 27903331 27905731 2\n4 0 27905897 27905992 4\n4 0 27906012 28011382 2\n4 0 28013028 28073214 4\n4 0 28073254 28073254 2\n4 0 28073277 28073282 4\n4 0 28073331 28207208 2\n4 0 28207234 28912210 4\n4 0 28912217 29145199 2\n4 0 29145267 29147021 4\n4 0 29147155 29198356 2\n4 0 29198367 33092913 4\n4 0 33093283 33093427 2\n4 0 33093442 33123404 4\n4 0 33123416 33123653 2\n4 0 33123700 33125403 4\n4 0 33125543 33125918 2\n4 0 33126085 33834922 4\n4 0 33834936 33835177 2\n4 0 33835186 33835186 4\n4 0 33835330 33835467 2\n4 0 33835499 33835499 4\n4 0 33835520 33835588 2\n4 0 33835609 34656585 4\n4 0 34656776 34888399 2\n4 0 34888612 34959330 3\n4 0 34959352 34959358 2\n4 0 34959377 34959377 3\n4 0 34959409 34961148 2\n4 0 34961612 35378242 3\n4 0 35378246 35411153 2\n4 0 35411169 35437241 3\n4 0 35437296 36360302 2\n4 0 36360442 36659268 3\n4 0 36659271 37105743 2\n5 0 1 33879771 3\n5 0 33879777 33932245 2\n5 0 33932269 33932296 1\n5 0 33932299 36537638 2\n5 0 36537747 36882083 1\n5 0 36882096 36882096 2\n5 0 36882151 36882151 1\n5 0 36882270 37521229 2\n5 0 37521490 37583975 1\n5 0 37584023 37620328 2\n5 0 37620461 37620486 1\n5 0 37621366 37638283 2\n5 0 37638310 37638397 1\n5 0 37638463 37661768 2\n5 0 37666013 37666217 1\n5 0 37666471 37666471 2\n5 0 37666483 37914896 1\n5 0 37916040 37919269 2\n5 0 37919496 37919505 1\n5 0 37919515 37935925 2\n5 0 37935982 37958445 1\n5 0 38002167 38002167 2\n5 0 38003162 38014999 1\n5 0 38015235 38016126 2\n5 0 38016164 38017429 1\n5 0 38017485 38017485 2\n5 0 38019162 38115235 1\n5 0 38115313 38115322 2\n5 0 38115325 38115325 1\n5 0 38115352 38221247 2\n5 0 38222701 38824997 1\n5 0 38825009 41853232 3\n6 0 1 979379 3\n6 0 979459 1282955 2\n6 0 1283167 2261915 4\n6 0 2261939 2262050 2\n6 0 2262056 2387874 4\n6 0 2387964 2402892 2\n6 0 2402931 2965627 4\n6 0 2965646 2983489 2\n6 0 2983737 2984075 4\n6 0 2984107 2984330 2\n6 0 2984430 2984586 4\n6 0 2984650 2985221 2\n6 0 2985704 3030421 4\n6 0 3030436 3126663 2\n6 0 3126775 3126775 4\n6 0 3126811 3127569 2\n6 0 3127664 3193800 4\n6 0 3301229 3590636 2\n6 0 3590740 3591415 3\n6 0 3591716 3591716 2\n6 0 3591902 7156372 3\n6 0 7156439 7304486 2\n6 0 7304536 11883582 3\n6 0 11883599 11903075 2\n6 0 11903168 15288300 3\n6 0 15288314 15288477 2\n6 0 15288500 15328041 3\n6 0 15328146 15341558 2\n6 0 15341885 29401706 3\n6 0 29401741 29403019 2\n6 0 29403025 29405982 4\n6 0 29406047 29406047 2\n6 0 29406068 29406068 4\n6 0 29406604 29406678 2\n6 0 29406807 29581471 4\n6 0 29581481 29581546 2\n6 0 29581552 30012100 4\n6 0 30012172 31023701 2\n6 0 31023765 37593364 3\n7 0 1 429098 1\n7 0 429194 459595 2\n7 0 459649 1007612 1\n7 0 1007663 1007918 2\n7 0 1014653 1014859 1\n7 0 1015032 1038207 2\n7 0 1038232 1177844 1\n7 0 1178033 1178033 2\n7 0 1178063 1202496 1\n7 0 1202513 1206940 2\n7 0 1207038 1234343 1\n7 0 1234349 1620623 2\n7 0 1620680 1621016 1\n7 0 1621130 1621181 2\n7 0 1621187 2965070 1\n7 0 2965081 2976354 2\n7 0 2980844 3003031 1\n7 0 3003051 3442195 2\n7 0 3442261 3557460 1\n7 0 3557562 3557670 2\n7 0 3557700 3612209 1\n7 0 3612227 3616873 2\n7 0 3616894 4054361 1\n7 0 4057772 4070385 2\n7 0 4070558 4674838 1\n7 0 4674885 5123603 2\n7 0 5126321 5126360 1\n7 0 5144345 5148793 2\n7 0 5149018 5213268 1\n7 0 5213283 5213294 2\n7 0 5253167 5363083 1\n7 0 5368688 5368730 2\n7 0 5391719 5392121 1\n7 0 5392279 5452236 2\n7 0 5452289 5666054 1\n7 0 5671739 5671739 2\n7 0 5675919 5677780 1\n7 0 5677897 5677979 2\n7 0 5687505 5689706 1\n7 0 5689739 5692307 2\n7 0 5693764 5693780 1\n7 0 5693849 5694093 2\n7 0 5694368 5827691 1\n7 0 5827750 5827750 2\n7 0 5827767 5827979 1\n7 0 5828010 5960698 2\n7 0 5960710 5960710 1\n7 0 5960730 5960730 2\n7 0 5960847 6046711 1\n7 0 6052650 6244740 2\n7 0 6244771 6245119 1\n7 0 6245236 6251738 2\n7 0 6251751 6831397 1\n7 0 6835813 6930958 2\n7 0 6931158 7186530 1\n7 0 7186553 7186553 2\n7 0 7186922 7186953 1\n7 0 7186960 7207120 2\n7 0 7207496 8422612 1\n7 0 8422645 8422943 2\n7 0 8445007 8445007 1\n7 0 8454662 8479521 2\n7 0 8479569 8534643 1\n7 0 8534746 8534746 2\n7 0 8534772 8536949 1\n7 0 8537040 8557085 2\n7 0 8558448 8558510 1\n7 0 8558563 8558563 2\n7 0 8558705 8558924 1\n7 0 8558989 8558989 2\n7 0 8559011 8601075 1\n7 0 8601320 8649444 2\n7 0 8649517 9440893 1\n7 0 9440947 9469605 2\n7 0 9469642 9512807 1\n7 0 9513096 9574839 2\n7 0 9574862 9574862 1\n7 0 9574934 10173616 2\n7 0 10179811 10476191 4\n7 0 10502675 10504975 2\n7 0 10505314 10671651 4\n7 0 10671686 10671690 2\n7 0 10671793 10671793 4\n7 0 10672665 10675920 2\n7 0 10676625 10677675 4\n7 0 10679706 10713089 2\n7 0 10716354 10716354 4\n7 0 10716423 10716648 2\n7 0 10716694 10734238 4\n7 0 10735167 10735530 2\n7 0 10740344 11040498 4\n7 0 11040508 11040685 2\n7 0 11040971 11042417 4\n7 0 11043199 11188282 2\n7 0 11189537 11201778 4\n7 0 11202073 11242282 2\n7 0 11284376 11322976 4\n7 0 11322988 11322988 2\n7 0 11323051 11325190 4\n7 0 11325193 11336670 2\n7 0 11341275 11341900 4\n7 0 11341921 11361048 2\n7 0 11361055 11487131 4\n7 0 11487295 27398739 2\n7 0 27400607 27400622 4\n7 0 27400628 27406256 2\n7 0 27406311 28051672 4\n7 0 28051842 28068208 2\n7 0 28068216 28068583 4\n7 0 28072364 28079007 2\n7 0 28079010 28086701 4\n7 0 28086852 28094601 2\n7 0 28094622 28095748 4\n7 0 28099658 28184423 2\n7 0 28184479 28279305 4\n7 0 28279373 29284918 2\n7 0 29284922 30217023 4\n7 0 30217186 30217232 2\n7 0 30217340 30217397 4\n7 0 30217425 30217433 2\n7 0 30217490 30275209 4\n7 0 30276933 30276933 2\n7 0 30276969 30287811 4\n7 0 30287838 32148522 3\n7 0 32148544 32148544 2\n7 0 32149023 32149447 3\n7 0 32149456 32150294 2\n7 0 32150347 32190257 3\n7 0 32192738 32192738 2\n7 0 32192768 32228700 3\n7 0 32228826 32315456 2\n7 0 32315460 32545490 3\n7 0 32545523 33023161 2\n7 0 33023177 34043957 3\n7 0 34043987 34466040 2\n7 0 34466115 34650704 4\n7 0 34650725 34650896 2\n7 0 34650908 34650926 4\n7 0 34650953 34651106 2\n7 0 34651193 35028021 4\n8 0 1 421631 3\n8 0 421637 581304 2\n8 0 581336 581336 3\n8 0 581523 581523 2\n8 0 581541 581541 3\n8 0 581544 1515374 2\n8 0 1515429 1515443 1\n8 0 1517003 1522514 2\n8 0 1522524 1522524 1\n8 0 1522550 1568722 2\n8 0 1568794 1569737 1\n8 0 1569740 1569752 2\n8 0 1569760 1569760 1\n8 0 1569902 1601374 2\n8 0 1601380 1601471 1\n8 0 1601531 1603666 2\n8 0 1603708 1603708 1\n8 0 1604380 1604380 2\n8 0 1608257 1608257 1\n8 0 1611887 1653158 2\n8 0 1653224 1732907 1\n8 0 1751272 1769181 2\n8 0 1769186 1769186 1\n8 0 1769221 1794838 2\n8 0 1794901 1794901 1\n8 0 1795020 1837302 2\n8 0 1837319 1856102 3\n8 0 1856116 1857310 2\n8 0 1857649 1914210 3\n8 0 1914219 1914612 2\n8 0 1927433 1958933 1\n8 0 1958978 2014329 2\n8 0 2015736 2087392 1\n8 0 2087410 2087410 2\n8 0 2088743 2176877 1\n8 0 2176955 2253831 2\n8 0 2253854 2266135 1\n8 0 2266172 2429903 2\n8 0 2429933 3215931 1\n8 0 3215935 3219748 2\n8 0 3219823 3219823 1\n8 0 3219856 3219874 2\n8 0 3220031 3222684 1\n8 0 3222726 3248459 2\n8 0 3248516 3248545 1\n8 0 3248548 3248548 2\n8 0 3248559 3266002 1\n8 0 3266093 3267404 2\n8 0 3267445 3267445 1\n8 0 3267504 3310555 2\n8 0 3310675 3714780 1\n8 0 3717313 4103850 2\n8 0 4104964 4759385 1\n8 0 4759427 4782340 2\n8 0 4782358 4782358 1\n8 0 4782392 4785495 2\n8 0 4785517 4785517 1\n8 0 4785662 4785687 2\n8 0 4785690 4804653 1\n8 0 4875550 4875550 2\n8 0 4875567 4905360 1\n8 0 4905437 4906584 2\n8 0 4906760 4906763 1\n8 0 4906823 4906823 2\n8 0 4909886 4917746 1\n8 0 4917789 4928876 2\n8 0 4928900 5042791 1\n8 0 5042837 5042837 2\n8 0 5043089 5043100 1\n8 0 5043116 5044721 2\n8 0 5045153 5064916 1\n8 0 5065640 5081020 2\n8 0 5081284 5122664 1\n8 0 5122721 5122744 2\n8 0 5122813 5122895 1\n8 0 5122934 5122994 2\n8 0 5123009 5139037 1\n8 0 5162715 5181348 2\n8 0 5181375 5304548 1\n8 0 5304955 5305111 2\n8 0 5305462 5858627 1\n8 0 5858651 6696893 2\n8 0 6696941 6706156 1\n8 0 6720717 6727064 2\n8 0 6727067 6741767 1\n8 0 6742308 6750735 2\n8 0 6750809 7184908 1\n8 0 7184975 7187069 2\n8 0 7187076 7187108 1\n8 0 7187118 7187189 2\n8 0 7187192 7187260 3\n8 0 7187283 7187326 2\n8 0 7187344 7190453 3\n8 0 7190549 7255437 2\n8 0 7268076 7282510 1\n8 0 7282570 7282871 3\n8 0 7282933 7329881 1\n8 0 7330218 7390201 2\n8 0 7390215 7390877 1\n8 0 7391036 7391036 2\n8 0 7391055 7392713 1\n8 0 7432886 7433004 2\n8 0 7433034 7433218 1\n8 0 7433269 7438320 2\n8 0 7438358 7442840 1\n8 0 7448431 7449895 2\n8 0 7449994 7538580 1\n8 0 7538625 7575059 2\n8 0 7575149 7578991 1\n8 0 7579740 7579740 2\n8 0 7580490 7614182 1\n8 0 7614320 7614320 2\n8 0 7614407 8238453 1\n8 0 8238549 8238888 2\n8 0 8238914 8375499 1\n8 0 8375532 8375552 2\n8 0 8375572 8375624 1\n8 0 8375743 8379018 2\n8 0 8379032 8420473 1\n8 0 8421929 8423068 2\n8 0 8423908 8424093 1\n8 0 8424158 8424158 2\n8 0 8424184 8458874 1\n8 0 8458934 8459289 2\n8 0 8463036 8544021 1\n8 0 8544039 8625669 2\n8 0 8625726 8644352 1\n8 0 8645309 10423874 2\n8 0 10424056 10430674 1\n8 0 10430892 10452772 2\n8 0 10452803 11244811 1\n8 0 11245035 11254950 2\n8 0 11255323 11272931 1\n8 0 11273018 11309801 2\n8 0 11309827 11377547 1\n8 0 11377675 11377731 2\n8 0 11377740 11377819 1\n8 0 11377963 11377978 2\n8 0 11378011 11378011 1\n8 0 11379755 12556698 2\n8 0 12556722 12556722 1\n8 0 12556729 12556729 2\n8 0 12556738 12754494 1\n8 0 12755221 12794834 2\n8 0 12794988 12795072 1\n8 0 12808738 14446575 2\n8 0 14446787 14709968 1\n8 0 14710625 14710655 2\n8 0 14710872 14860100 1\n8 0 14860299 14863197 2\n8 0 14863223 14864406 1\n8 0 14864808 14864808 2\n8 0 14865145 14992847 1\n8 0 14994446 15131005 2\n8 0 15135635 15173003 1\n8 0 15173119 15178108 2\n8 0 15178130 28308956 1\n8 0 28496646 29434822 2\n8 0 29434849 35737186 1\n8 0 35737463 35774142 2\n8 0 35774167 35774267 3\n8 0 35774314 35934409 2\n8 0 35937239 35940334 1\n8 0 35940521 35995221 2\n8 0 35996487 36345818 1\n8 0 36345843 36412443 2\n8 0 36412500 36417659 1\n8 0 36427029 36427029 2\n8 0 36427364 37656260 1\n8 0 37656275 37782330 2\n8 0 37782333 37784761 1\n8 0 37785266 37787981 2\n8 0 37788008 37788269 1\n8 0 37790355 37805770 2\n8 0 37806131 37807548 1\n8 0 37826063 38236631 2\n8 0 38236661 38251867 1\n8 0 38252080 38302757 2\n8 0 38302919 38302919 1\n8 0 38303093 38305626 2\n8 0 38305635 38305962 1\n8 0 38306094 38431542 2\n8 0 38431557 38729378 1\n8 0 38729434 38729434 2\n8 0 38729577 38729625 1\n8 0 38729730 38875697 2\n8 0 38895434 38992481 1\n8 0 38992688 38994236 2\n8 0 38994278 39087588 1\n8 0 39088932 39090265 2\n8 0 39090445 39870673 1\n8 0 39870682 39879688 2\n8 0 39879776 39906553 1\n8 0 39909290 40238578 2\n8 0 40239534 40401359 1\n8 0 40401368 40401368 2\n8 0 40401387 40401387 1\n8 0 40401491 41200503 2\n8 0 41200519 41561744 1\n8 0 41561801 41584223 2\n8 0 41584250 41584250 1\n8 0 41584271 42787686 2\n8 0 42787719 42787744 1\n8 0 42787756 42916970 2\n8 0 42917024 42917229 1\n8 0 42917241 42918347 2\n8 0 42918372 43337393 1\n8 0 43337403 43882621 2\n8 0 43882732 43882732 3\n8 0 43882750 43911139 2\n8 0 43911329 43911334 3\n8 0 43911394 43911394 2\n8 0 43911827 43911827 3\n8 0 43912095 44889171 2\n9 0 1 497992 4\n9 0 497995 497995 2\n9 0 498007 498007 4\n9 0 498021 546083 2\n9 0 546181 1206624 3\n9 0 1206643 1625140 2\n9 0 1625161 6164315 3\n9 0 6164344 6991662 2\n9 0 6992905 8005673 4\n9 0 8005677 8009540 2\n9 0 8009561 8009570 4\n9 0 8009615 8018324 2\n9 0 8018434 8018434 4\n9 0 8018450 8018450 2\n9 0 8018453 8018498 4\n9 0 8018511 8018722 2\n9 0 8020382 8043481 4\n9 0 8099938 8148700 2\n9 0 8148709 8148755 4\n9 0 8148943 8505845 2\n9 0 8505944 9289067 4\n9 0 9289114 9978821 2\n9 0 9978943 9989681 4\n9 0 9992017 9993934 2\n9 0 9993953 9994579 4\n9 0 9994642 9994642 2\n9 0 9994667 36594218 4\n9 0 36594359 36634675 2\n9 0 36634760 36634871 4\n9 0 36634883 36635625 2\n9 0 36638253 36653030 4\n9 0 36653176 36655294 2\n9 0 36655331 36656504 4\n9 0 36656507 36656570 2\n9 0 36656586 36703926 4\n9 0 36703999 36988050 2\n9 0 36988065 37139078 4\n9 0 37139110 37183572 2\n9 0 37186455 37189086 4\n9 0 37189098 37200524 2\n9 0 37200584 37200584 4\n9 0 37200607 37204708 2\n9 0 37204762 37281701 4\n9 0 37281829 37283526 2\n9 0 37284582 38779887 4\n9 0 38779967 38779967 2\n9 0 38780093 38780135 4\n9 0 38780159 38974917 1\n9 0 38975062 39049807 2\n9 0 39050042 39420153 1\n9 0 39420156 39421609 3\n9 0 39421647 39421647 1\n9 0 39425530 39425530 3\n9 0 39425534 39427379 1\n9 0 39427503 39435570 3\n9 0 39435600 39511559 1\n9 0 39512681 39512799 3\n9 0 39512871 39515993 1\n9 0 39516857 39759461 3\n9 0 39759628 39760594 2\n9 0 39760618 39760618 3\n9 0 39761132 40384898 2\n9 0 40384907 40384950 1\n9 0 40384984 40385852 2\n9 0 40387369 40430362 1\n9 0 40430365 40430365 2\n9 0 40430409 40580598 1\n9 0 40580631 40712211 2\n9 0 40712229 40773024 1\n9 0 40773043 40773043 2\n9 0 40773072 40773598 1\n9 0 40773792 40779635 2\n9 0 40779706 40791603 1\n9 0 40792558 40913704 2\n9 0 40913739 40914872 1\n9 0 40914899 40914980 2\n9 0 40914991 40924598 1\n9 0 40924622 40925049 2\n9 0 40925173 41306725 1\n10 0 1 5550833 3\n10 0 5551066 9658662 2\n10 0 9659024 9736395 4\n10 0 9736526 14215611 2\n10 0 14215639 14225826 4\n10 0 14226106 14226106 2\n10 0 14226226 15818802 4\n10 0 15818930 15821097 1\n10 0 15821722 15821853 4\n10 0 15824308 15827326 1\n10 0 15829234 15834738 4\n10 0 15834744 15835495 1\n10 0 15835531 15836693 4\n10 0 15837911 15854536 1\n10 0 15854560 15854560 4\n10 0 15854636 15854636 1\n10 0 15854673 22159160 4\n10 0 22159413 22284830 2\n10 0 22285071 22285071 3\n10 0 22285087 22285096 2\n10 0 22286758 37674811 3\n11 0 1 795450 3\n11 0 795466 849536 2\n11 0 860687 23960926 3\n11 0 23963454 23963454 2\n11 0 23963497 23989231 3\n11 0 23990777 23990808 2\n11 0 23990840 24005507 3\n11 0 24005519 24187265 2\n11 0 24187489 24211074 3\n11 0 24211125 24289224 2\n11 0 24289231 26026526 3\n11 0 26026681 26781485 2\n11 0 26781539 27000554 4\n11 0 27000608 27000695 2\n11 0 27000743 27006382 4\n11 0 27006622 27007275 2\n11 0 27007438 27007778 4\n11 0 27007839 27138825 2\n11 0 27139092 27139092 4\n11 0 27139110 27139437 2\n11 0 27139611 27143068 4\n11 0 27143127 27183174 2\n11 0 27183181 27226399 4\n11 0 27226476 27226476 2\n11 0 27227398 27229524 4\n11 0 27230765 27260614 2\n11 0 27260905 27366539 4\n11 0 27366551 27395150 2\n11 0 27395270 27395285 4\n11 0 27396783 27954350 2\n1 1 1 409357 2\n1 1 409365 415556 1\n1 1 415565 415861 2\n1 1 416194 416194 4\n1 1 416378 436858 2\n1 1 437703 1901283 4\n1 1 1901352 1902790 2\n1 1 1902820 1903746 4\n1 1 1921506 1954277 2\n1 1 1954299 1954299 4\n1 1 1954310 2060466 2\n1 1 2060483 2060744 4\n1 1 2061417 2061431 2\n1 1 2061506 2061506 4\n1 1 2061986 2074215 2\n1 1 2074248 2075663 4\n1 1 2075684 2142633 2\n1 1 2142745 2341981 4\n1 1 2342009 2342759 2\n1 1 2342861 2343485 4\n1 1 2343523 2343523 2\n1 1 2343652 2352757 4\n1 1 2352786 2352961 2\n1 1 2352967 2354742 4\n1 1 2356112 2358542 2\n1 1 2358548 2358548 4\n1 1 2362401 2363536 2\n1 1 2363557 2368597 4\n1 1 2368603 2448656 2\n1 1 2448757 29070452 3\n2 1 1 16393340 1\n2 1 16394140 16396345 2\n2 1 16457184 16457216 1\n2 1 16457231 16457231 2\n2 1 16457234 16457234 1\n2 1 16457343 17469746 2\n2 1 17469809 17473522 1\n2 1 17473594 17474105 2\n2 1 17474882 17476296 1\n2 1 17477032 17477032 2\n2 1 17477056 17477358 1\n2 1 17477403 17477403 2\n2 1 17477544 18198583 1\n2 1 18199965 18277700 2\n2 1 18277801 18393640 1\n2 1 18394367 18501338 2\n2 1 18501372 18523144 1\n2 1 18523156 18523156 2\n2 1 18523162 18523912 1\n2 1 18523987 18577245 2\n2 1 18616385 18921634 1\n2 1 18921933 18939676 2\n2 1 18940279 18941332 1\n2 1 18941449 18941542 2\n2 1 18941587 18941587 1\n2 1 18941933 18941933 2\n2 1 18947631 18948126 1\n2 1 18948153 18948198 2\n2 1 18948892 18967862 1\n2 1 18968121 18968121 2\n2 1 18968136 18968136 1\n2 1 18968187 21638924 2\n2 1 21639185 21639185 3\n2 1 21639398 21639425 2\n2 1 21639485 27280454 3\n2 1 27280566 27280566 1\n2 1 27280580 27281286 3\n2 1 27281318 27819366 1\n2 1 27819370 27819370 2\n2 1 27819566 27819566 1\n2 1 27820666 27859680 2\n2 1 27860160 28115651 1\n2 1 28115659 28116125 2\n2 1 28116350 28743070 1\n2 1 28743181 28745156 3\n2 1 28749044 28758426 1\n2 1 28759245 29511734 3\n3 1 1 24803640 3\n3 1 24803674 24811809 2\n3 1 24811852 24812146 3\n3 1 24812154 24939507 2\n3 1 24939590 24939590 3\n3 1 24946135 24946211 2\n3 1 24946911 24946911 3\n3 1 24946938 24976120 2\n3 1 24976292 25433746 3\n3 1 25452015 25457677 2\n3 1 25457687 25612027 3\n3 1 25612042 26742443 2\n3 1 26742563 26816296 1\n3 1 26816397 26816397 2\n3 1 26816446 26973782 1\n3 1 26974765 26983817 2\n3 1 26983846 27213113 1\n3 1 27213166 27223341 2\n3 1 27223601 27223727 1\n3 1 27225005 27226659 2\n3 1 27226671 27314743 1\n3 1 27314752 27501799 4\n3 1 27502090 27507097 1\n3 1 27507129 27605109 4\n3 1 27605137 29054460 2\n3 1 29055739 29055846 1\n3 1 29055851 29060467 2\n3 1 29060799 29060799 1\n3 1 29060820 29063497 2\n3 1 29063505 29072702 1\n3 1 29072726 29075851 2\n3 1 29075898 29076292 1\n3 1 29092065 29128695 2\n3 1 29128821 29200237 1\n3 1 29200279 29228965 2\n3 1 29242516 29325808 1\n3 1 29326177 29434582 2\n3 1 29434623 29453553 1\n3 1 29453902 29454083 2\n3 1 29454089 29517204 1\n3 1 29519158 29528517 2\n3 1 29528535 29874568 1\n3 1 29874669 29874669 2\n3 1 29874702 29874702 1\n3 1 29874708 30819171 2\n3 1 30819195 30819347 3\n3 1 30862906 30862931 2\n3 1 30862946 30863616 3\n3 1 30863716 30863740 2\n3 1 30863758 30864288 3\n3 1 30864326 31533802 2\n3 1 31533853 31575622 1\n3 1 31578301 33854464 2\n3 1 33854515 33854515 1\n3 1 33854521 33854702 2\n3 1 33854714 33885584 1\n3 1 33885596 33885647 2\n3 1 33885767 34462495 1\n3 1 34462534 34462534 2\n3 1 34462543 34478214 1\n3 1 34478226 35020413 2\n4 1 1 743421 2\n4 1 743657 743742 1\n4 1 743802 744054 2\n4 1 744415 744508 1\n4 1 744521 1285183 2\n4 1 1287268 1311360 1\n4 1 1311476 1395694 2\n4 1 1395706 1453336 1\n4 1 1453483 1822396 2\n4 1 1822423 1830279 1\n4 1 1830450 1830491 2\n4 1 1831565 1831565 1\n4 1 1832078 1832078 2\n4 1 1833483 1843527 1\n4 1 1843609 2724080 2\n4 1 2725115 3539756 1\n4 1 3539774 3539774 2\n4 1 3539849 3539849 1\n4 1 3539852 3539864 2\n4 1 3539876 3539901 1\n4 1 3539966 3587551 2\n4 1 3587599 3587599 1\n4 1 3588320 3588320 2\n4 1 3588341 3682210 1\n4 1 3682233 3682233 2\n4 1 3684510 3786535 1\n4 1 3786542 3790427 2\n4 1 3790436 3841560 1\n4 1 3841566 3841566 2\n4 1 3841626 3841638 1\n4 1 3841671 3859417 2\n4 1 3859425 3859441 1\n4 1 3859444 3883291 2\n4 1 3885391 3893772 1\n4 1 3893943 3901096 2\n4 1 3925866 4008372 1\n4 1 4010567 4130795 2\n4 1 4132720 4957485 1\n4 1 4957567 5324408 2\n4 1 5325944 6058640 1\n4 1 6058643 6548008 2\n4 1 6548066 6571133 1\n4 1 6579012 6584652 2\n4 1 6584688 6584688 1\n4 1 6585215 6586112 2\n4 1 6586121 6666892 1\n4 1 6667017 6689483 2\n4 1 6689791 7079057 1\n4 1 7079371 7079371 2\n4 1 7079402 7079652 1\n4 1 7080530 7147827 2\n4 1 7147833 7147935 1\n4 1 7148073 7148073 2\n4 1 7148205 7148205 1\n4 1 7148346 7185463 2\n4 1 7185475 7186327 1\n4 1 7186338 7194140 2\n4 1 7194169 7194169 1\n4 1 7194307 7775789 2\n4 1 7775828 7903591 1\n4 1 7903663 7908336 2\n4 1 7908366 7908494 1\n4 1 7909249 7909249 2\n4 1 7909261 7909288 1\n4 1 7909302 7909384 2\n4 1 7909426 7909492 1\n4 1 7914152 7914152 2\n4 1 7914233 7914233 1\n4 1 7914296 7914305 2\n4 1 7914540 7924265 1\n4 1 7924283 7927892 2\n4 1 7928941 7928949 1\n4 1 7932501 7967379 2\n4 1 7967409 8080222 1\n4 1 8080252 8100162 2\n4 1 8100171 8100378 1\n4 1 8127598 8180628 2\n4 1 8180651 8324142 1\n4 1 8324146 8326436 2\n4 1 8326447 8329376 1\n4 1 8330815 8334281 2\n4 1 8336862 8336862 1\n4 1 8336913 8379219 2\n4 1 8379340 8379588 1\n4 1 8393943 8393943 2\n4 1 8414277 8414307 1\n4 1 8414450 8414549 2\n4 1 8414624 9707148 1\n4 1 9707177 9804271 2\n4 1 9804302 9838480 1\n4 1 9838504 9883676 2\n4 1 9883754 9883754 1\n4 1 9884638 9909296 2\n4 1 9909325 9909506 1\n4 1 9909623 10210734 2\n4 1 10210762 10211558 1\n4 1 10211614 10211648 2\n4 1 10211975 10212469 1\n4 1 10217491 10217500 2\n4 1 10217515 10222310 1\n4 1 10222313 10292515 2\n4 1 10292750 10417407 1\n4 1 10417443 10549622 2\n4 1 10549888 10558896 1\n4 1 10573681 10787868 2\n4 1 10787881 10828398 1\n4 1 10828467 10828488 2\n4 1 10828680 10828680 1\n4 1 10849518 10851983 2\n4 1 10852010 10852045 1\n4 1 10852128 10852242 2\n4 1 10852263 10852485 1\n4 1 10852634 10852634 2\n4 1 10852637 10908245 1\n4 1 10908269 10908278 2\n4 1 10908448 11100323 1\n4 1 11100329 11107093 2\n4 1 11107097 11199244 1\n4 1 11202863 11204545 2\n4 1 11204625 11274562 1\n4 1 11274610 11274629 2\n4 1 11275101 22361220 1\n4 1 22381157 22500235 2\n4 1 22500242 22998812 1\n4 1 22998842 23027474 2\n4 1 23027527 23671605 1\n4 1 23671609 23672941 2\n4 1 23672953 23672953 1\n4 1 23672977 24068273 2\n4 1 24068276 24893131 1\n4 1 24893189 25270320 2\n4 1 25270323 26232463 1\n4 1 26232493 26232559 2\n4 1 26234984 26264597 1\n4 1 26264651 26349281 2\n4 1 26349290 26524456 1\n4 1 26524477 26552310 2\n4 1 26552432 26555591 1\n4 1 26555609 26569505 2\n4 1 26569637 26572024 1\n4 1 26572032 26647331 2\n4 1 26647519 26647643 1\n4 1 26647875 26670593 2\n4 1 26670599 26673221 1\n4 1 26673339 26787362 2\n4 1 26787395 26808819 1\n4 1 26808858 26810536 2\n4 1 26810556 26817263 1\n4 1 26817374 26888252 2\n4 1 26890242 26890532 1\n4 1 26890586 26890666 2\n4 1 26890691 26891066 1\n4 1 26891658 26892248 2\n4 1 26892472 26923317 1\n4 1 26923392 26923454 2\n4 1 26923868 26923868 1\n4 1 26923985 26978786 2\n4 1 26978794 26978794 1\n4 1 26978842 26985380 2\n4 1 26985411 27049246 1\n4 1 27049272 27059555 2\n4 1 27059665 27063634 1\n4 1 27137379 27137418 2\n4 1 27137439 27155885 1\n4 1 27155946 27169553 2\n4 1 27170264 27170291 1\n4 1 27170436 27187315 2\n4 1 27187355 27376474 1\n4 1 27376531 27378433 2\n4 1 27378518 27392217 1\n4 1 27392221 27392250 2\n4 1 27411405 27412429 1\n4 1 27412501 27412752 2\n4 1 27415014 27415203 1\n4 1 27415221 27415221 2\n4 1 27415679 27473952 1\n4 1 27474472 27476249 2\n4 1 27481410 27485749 1\n4 1 27487154 27532999 2\n4 1 27533113 27562494 1\n4 1 27564926 27564926 2\n4 1 27564929 27564929 1\n4 1 27564978 27764345 2\n4 1 27764485 27767107 1\n4 1 27767206 27767206 2\n4 1 27767257 27767829 1\n4 1 27767874 27787862 2\n4 1 27787933 27788012 1\n4 1 27788063 27790014 2\n4 1 27790020 27905897 1\n4 1 27905932 27905992 2\n4 1 27906012 27906012 1\n4 1 27906103 27906103 2\n4 1 27906263 27959843 1\n4 1 27959862 27981621 2\n4 1 27981631 28073439 1\n4 1 28073466 28076061 2\n4 1 28076232 28097696 1\n4 1 28097743 28097801 2\n4 1 28097805 29241317 1\n4 1 29246626 29592577 2\n4 1 29592594 29592972 3\n4 1 29634292 29646285 2\n4 1 29646377 29646377 3\n4 1 29646384 29658569 2\n4 1 29658604 29660367 3\n4 1 29660388 29660388 2\n4 1 29668306 29668306 3\n4 1 29668368 29668424 2\n4 1 29668838 29841646 3\n4 1 29841677 29841707 2\n4 1 29841740 29854648 3\n4 1 29858855 29859349 2\n4 1 29859364 32223654 3\n4 1 32223663 32223663 2\n4 1 32223683 32223683 3\n4 1 32223738 32223806 2\n4 1 32223833 32225008 3\n4 1 32225104 32226637 2\n4 1 32226796 32226796 3\n4 1 32226842 32880929 2\n4 1 32881086 32955840 3\n4 1 32955865 32963974 2\n4 1 32963987 33485416 3\n4 1 33485612 33486488 2\n4 1 33486536 35669120 3\n4 1 35670026 36145364 2\n4 1 36183959 37105743 3\n5 1 1 602788 2\n5 1 602809 2539512 4\n5 1 2539543 2540394 2\n5 1 2540412 2542309 4\n5 1 2542345 2713512 2\n5 1 2715978 3423353 3\n5 1 3423359 3423509 2\n5 1 3423530 3423530 3\n5 1 3423550 3464729 2\n5 1 3464763 6832526 3\n5 1 6832553 6838817 2\n5 1 6839046 8153469 3\n5 1 8153484 9449930 2\n5 1 9449982 10792977 4\n5 1 10793023 10793251 2\n5 1 10793285 10806897 4\n5 1 10806903 10809062 2\n5 1 10809132 35088845 4\n5 1 35088968 35118595 2\n5 1 35118737 35151163 4\n5 1 35151181 35151422 2\n5 1 35151434 35387590 4\n5 1 35387817 35387817 2\n5 1 35387877 35388509 4\n5 1 35388545 35390601 2\n5 1 35392067 35434430 4\n5 1 35434550 35434550 2\n5 1 35434757 35434988 4\n5 1 35435156 35575125 2\n5 1 35669651 35887103 4\n5 1 35887118 36002412 2\n5 1 36073604 37766481 4\n5 1 37766503 37785763 2\n5 1 37785781 37837359 4\n5 1 37837386 37898239 2\n5 1 37898302 37899859 4\n5 1 37899865 37914251 2\n5 1 37914256 37914896 4\n5 1 37916040 37916040 2\n5 1 37916052 38010088 4\n5 1 38014810 38017396 2\n5 1 38017429 38019226 4\n5 1 38021008 38115235 2\n5 1 38115313 38115559 4\n5 1 38115871 38141719 2\n5 1 38141762 38217140 4\n5 1 38217233 38217311 2\n5 1 38217690 38218681 4\n5 1 38218693 38536101 2\n5 1 38536274 38536325 3\n5 1 38536454 38628244 2\n5 1 38628266 38825009 3\n5 1 38825042 38825101 1\n5 1 38825108 38887545 3\n5 1 38887575 38912486 2\n5 1 38912825 39026630 3\n5 1 39026652 39026673 2\n5 1 39026728 39026839 3\n5 1 39026845 39051445 2\n5 1 39051458 39051485 3\n5 1 39051593 39670169 2\n5 1 39670781 39683762 3\n5 1 39683780 39718275 2\n5 1 39718453 39718453 1\n5 1 39718458 39720273 2\n5 1 39720377 39867268 1\n5 1 39867280 40261887 2\n5 1 40261904 40349364 1\n5 1 40349384 40689908 2\n5 1 40689938 40838256 3\n5 1 40838272 40838346 2\n5 1 40838386 40854031 3\n5 1 40865934 41853232 2\n6 1 1 1586152 2\n6 1 1586165 1665438 1\n6 1 1687824 1687824 2\n6 1 1687859 1718324 1\n6 1 1718348 5202801 2\n6 1 5202840 5254147 1\n6 1 5258271 5292712 2\n6 1 5293168 5294152 1\n6 1 5294251 5295013 2\n6 1 5295280 5348536 1\n6 1 5348548 5391887 2\n6 1 5391947 5391947 1\n6 1 5392106 5392596 2\n6 1 5394737 5394782 1\n6 1 5394848 5396900 2\n6 1 5396981 5397184 1\n6 1 5397189 5397189 2\n6 1 5397196 5446792 1\n6 1 5446858 5446979 2\n6 1 5448509 5459321 1\n6 1 5459345 6769480 2\n6 1 6769557 6769818 3\n6 1 6769923 6836115 2\n6 1 6836125 6849112 1\n6 1 6850310 6852268 2\n6 1 6852317 6898811 1\n6 1 6898825 6898882 2\n6 1 6902848 7150614 1\n6 1 7150625 7150625 2\n6 1 7152144 7152157 1\n6 1 7152275 7204251 2\n6 1 7204259 7211039 1\n6 1 7213989 7853699 2\n6 1 7853793 8080253 1\n6 1 8080284 8081496 2\n6 1 8084539 8084762 1\n6 1 8085575 8087755 2\n6 1 8088114 8096882 1\n6 1 8096948 8113903 2\n6 1 8113929 8142787 1\n6 1 8142833 8496093 2\n6 1 8512775 8525767 1\n6 1 8525804 8542188 2\n6 1 8542207 8938298 1\n6 1 8938735 8938735 2\n6 1 8938801 8942755 1\n6 1 8943154 9124645 2\n6 1 9124842 9135212 1\n6 1 9140477 9269387 2\n6 1 9269468 9299112 1\n6 1 9299117 9299117 2\n6 1 9299133 9569841 1\n6 1 9569967 9572539 2\n6 1 9572700 9781315 1\n6 1 9781428 10449747 2\n6 1 10450637 10459236 1\n6 1 10459263 10463483 2\n6 1 10463530 10557634 3\n6 1 10557726 10566183 2\n6 1 10566187 10566187 3\n6 1 10566214 10727190 2\n6 1 10728203 10815012 1\n6 1 10815168 11866732 2\n6 1 11866744 11866880 1\n6 1 11866967 11867206 2\n6 1 11867270 11868047 1\n6 1 11868089 11868255 2\n6 1 11868281 11868281 1\n6 1 11868358 11882372 2\n6 1 11882420 11882420 1\n6 1 11882447 11984447 2\n6 1 11984503 12005708 1\n6 1 12005744 12013592 2\n6 1 12013596 12013596 1\n6 1 12013632 12126540 2\n6 1 12126557 12157612 1\n6 1 12159160 12160507 2\n6 1 12160559 12160559 1\n6 1 12160562 12179862 2\n6 1 12179865 12179919 1\n6 1 12179939 12199651 2\n6 1 12222366 12222366 1\n6 1 12222454 12222566 2\n6 1 12222590 12249298 1\n6 1 12249347 12249351 2\n6 1 12249406 12254161 1\n6 1 12254283 12255408 2\n6 1 12255614 12257584 1\n6 1 12257911 12274430 2\n6 1 12274446 12274775 1\n6 1 12274905 12275135 2\n6 1 12275174 12275174 1\n6 1 12275235 12281845 2\n6 1 12281876 12281876 1\n6 1 12281884 12282073 2\n6 1 12282136 12282136 1\n6 1 12282829 17031585 2\n6 1 17031705 17032203 1\n6 1 17032216 17458614 2\n6 1 17460848 17460848 1\n6 1 17460899 17460899 2\n6 1 17461209 26244682 1\n6 1 26244853 26248377 2\n6 1 26248384 26314995 1\n6 1 26315003 26315104 2\n6 1 26391878 26393370 1\n6 1 26393375 26490442 2\n6 1 26490562 26490897 1\n6 1 26491187 26631099 2\n6 1 26631132 27821165 1\n6 1 27825730 29196631 2\n6 1 29196685 29433241 1\n6 1 29433355 29468511 2\n6 1 29468516 29473465 1\n6 1 29495956 29496940 2\n6 1 29496970 29496970 1\n6 1 29497184 29497184 2\n6 1 29499047 29499047 1\n6 1 29499055 29499055 2\n6 1 29499058 29499058 1\n6 1 29499081 29499081 3\n6 1 29499085 29499226 1\n6 1 29499246 29499268 2\n6 1 29499504 29499504 1\n6 1 29499522 29502277 2\n6 1 29502314 29503780 1\n6 1 29503804 29504029 2\n6 1 29504240 29581471 1\n6 1 29581481 29581481 2\n6 1 29581498 29581498 1\n6 1 29581546 29581546 2\n6 1 29581552 29581552 1\n6 1 29581613 29581646 2\n6 1 29581675 29695885 1\n6 1 29698078 29698211 2\n6 1 29698268 29725207 1\n6 1 29725243 29764726 2\n6 1 29764745 29849826 1\n6 1 29849892 29986717 2\n6 1 29987181 29987181 1\n6 1 29992419 29992424 2\n6 1 29992900 29992900 1\n6 1 29992916 29992955 2\n6 1 29994837 29995046 1\n6 1 29995094 30005259 2\n6 1 30005274 30069269 1\n6 1 30069420 30840658 2\n6 1 30840769 32108337 1\n6 1 32108350 32108373 2\n6 1 32108394 32117788 1\n6 1 32125274 32671930 2\n6 1 32671939 32718859 1\n6 1 32726185 33097246 2\n6 1 33097270 33103495 1\n6 1 33103588 33104154 2\n6 1 33104233 33104255 1\n6 1 33110073 33111562 2\n6 1 33111577 33111577 1\n6 1 33111610 33111610 2\n6 1 33111648 33209388 1\n6 1 33212170 33215841 2\n6 1 33215993 33215993 1\n6 1 33216007 33893012 2\n6 1 33893259 34752048 1\n6 1 34752138 34752264 2\n6 1 34752339 34863236 1\n6 1 34863264 37593364 2\n7 1 1 2150040 3\n7 1 2150066 2157563 2\n7 1 2157617 2162011 4\n7 1 2162083 2162892 2\n7 1 2183536 3174538 4\n7 1 3174611 3213591 2\n7 1 3213729 3242148 4\n7 1 3242251 3249867 2\n7 1 3249943 6620508 4\n7 1 6622003 6631636 2\n7 1 6631702 6677349 4\n7 1 6677382 6691270 2\n7 1 6691285 8422738 4\n7 1 8422807 8488442 2\n7 1 8488567 8488567 4\n7 1 8503563 8689034 2\n7 1 8689054 8689054 4\n7 1 8689088 8840308 2\n7 1 8902072 8909155 4\n7 1 8909214 8917060 2\n7 1 8917070 33004263 4\n7 1 33004329 33425622 2\n7 1 33425642 35028021 4\n8 1 1 8170950 3\n8 1 8171129 8172592 2\n8 1 8173233 8173233 3\n8 1 8173323 8457202 2\n8 1 8457434 15925465 4\n8 1 15925507 15925543 2\n8 1 15925561 15943463 4\n8 1 15943485 16092167 2\n8 1 16092221 16150122 4\n8 1 16150350 16150925 2\n8 1 16150941 16151002 4\n8 1 16190549 16748956 2\n8 1 16749043 16754084 4\n8 1 16755474 17130461 2\n8 1 17130749 18043409 4\n8 1 18043415 18043415 2\n8 1 18043517 18554232 4\n8 1 18556636 18955582 2\n8 1 18955594 18959644 4\n8 1 18959666 18959666 2\n8 1 18959715 18980746 4\n8 1 18982101 19979103 2\n8 1 19982794 20036959 4\n8 1 20039540 20523231 2\n8 1 20523355 20523942 4\n8 1 20523975 20525212 2\n8 1 20525335 20721564 4\n8 1 20721590 20721603 2\n8 1 20721729 20780561 4\n8 1 20780800 21809935 2\n8 1 21810051 33386376 4\n8 1 33386519 33389728 2\n8 1 33390513 33390611 4\n8 1 33390620 33390620 2\n8 1 33390625 33390625 4\n8 1 33390636 33390636 2\n8 1 33390734 33428606 4\n8 1 33428627 33790129 2\n8 1 33790157 37014078 3\n8 1 37014244 37454933 2\n8 1 37455341 37456626 3\n8 1 37456767 37456767 2\n8 1 37457273 44889171 3\n9 1 1 740316 2\n9 1 740355 974112 3\n9 1 974171 1034304 1\n9 1 1034337 1066988 3\n9 1 1093677 1094035 1\n9 1 1094069 1131746 3\n9 1 1132052 1938136 2\n9 1 1942097 1955993 1\n9 1 1956531 1956531 2\n9 1 1957034 1999129 1\n9 1 2001138 2160907 2\n9 1 2160949 2161230 1\n9 1 2161338 2161338 2\n9 1 2161578 2479339 1\n9 1 2480571 2480647 2\n9 1 2487798 2489114 1\n9 1 2489132 2489322 2\n9 1 2489325 2499914 1\n9 1 2499950 2516411 2\n9 1 2517490 2568251 3\n9 1 2568600 2568704 2\n9 1 2568730 2568730 3\n9 1 2568798 2576241 2\n9 1 2576772 2576798 1\n9 1 2592746 2593454 2\n9 1 2593505 2594276 1\n9 1 2594333 2641114 3\n9 1 2641253 2641306 2\n9 1 2641323 2951259 3\n9 1 2951275 3037876 2\n9 1 3037916 3037916 3\n9 1 3037924 3042860 2\n9 1 3044192 3089437 3\n9 1 3089468 3089468 2\n9 1 3089858 3094117 1\n9 1 3094171 3095001 2\n9 1 3095016 3095248 3\n9 1 3095289 3096540 2\n9 1 3096655 3219581 1\n9 1 3219586 3219887 2\n9 1 3220080 3915319 1\n9 1 3915345 3926565 2\n9 1 3926883 3927027 1\n9 1 3927042 3937480 2\n9 1 3937785 4001236 1\n9 1 4001310 4306958 2\n9 1 4318729 4360280 1\n9 1 4360562 4401577 2\n9 1 4401611 4410563 1\n9 1 4410570 5243385 2\n9 1 5243398 5319181 1\n9 1 5319214 5630691 2\n9 1 5630820 5663027 1\n9 1 5663082 5763577 2\n9 1 5763613 5786115 1\n9 1 5866365 5866438 2\n9 1 5866451 5866451 1\n9 1 5866478 5906509 2\n9 1 5906527 5906527 1\n9 1 5906556 5923820 2\n9 1 5923825 5996353 1\n9 1 5996373 5996624 2\n9 1 5997371 7490331 1\n9 1 7490339 7544240 2\n9 1 7544270 8227831 1\n9 1 8227872 8680712 2\n9 1 8680803 8680803 3\n9 1 8680814 8691576 2\n9 1 8691674 11897120 3\n9 1 11897161 11897921 2\n9 1 11899402 11899402 3\n9 1 11908139 11908139 2\n9 1 11908193 11918632 3\n9 1 11935786 17244319 2\n9 1 17244407 17244431 3\n9 1 17246531 17942249 2\n9 1 17955716 23747543 3\n9 1 23747599 34780975 2\n9 1 34781004 34843119 3\n9 1 34843433 34843464 2\n9 1 34843493 34931830 3\n9 1 34932222 34934439 2\n9 1 34936222 35087814 3\n9 1 35087836 35693848 2\n9 1 35693854 37706041 3\n9 1 37706308 38754205 2\n9 1 38754319 38754319 1\n9 1 38754352 38754352 2\n9 1 38754406 38754580 1\n9 1 38754592 38779678 2\n9 1 38779738 38780200 3\n9 1 38780239 38780359 2\n9 1 38780401 38780425 3\n9 1 38780440 38786995 2\n9 1 38787034 40055724 3\n9 1 40055727 40348857 2\n9 1 40348982 41306725 3\n10 1 1 4013507 2\n10 1 4013519 4320409 1\n10 1 4320413 4323262 2\n10 1 4323424 21982836 1\n10 1 21982901 21998544 2\n10 1 21998612 21998917 1\n10 1 21998954 21998954 2\n10 1 21998962 21999124 1\n10 1 21999150 21999150 2\n10 1 21999271 21999847 1\n10 1 21999876 22000041 2\n10 1 22000065 22000351 1\n10 1 22000381 22017642 2\n10 1 22018241 22018241 1\n10 1 22018328 22018756 2\n10 1 22074432 22076076 1\n10 1 22077843 22077843 2\n10 1 22077847 22085000 1\n10 1 22085830 22088262 2\n10 1 22088280 22939933 1\n10 1 22940058 23297506 2\n10 1 23297516 24099155 1\n10 1 24099180 24379011 2\n10 1 24379103 24379103 4\n10 1 24379223 24438651 2\n10 1 24438707 24920962 4\n10 1 24921694 24942016 2\n10 1 24942029 24942192 3\n10 1 24942209 24957708 2\n10 1 24957764 26815654 3\n10 1 26818029 26818643 2\n10 1 26818828 26818916 3\n10 1 26818972 26818972 2\n10 1 26820868 26831461 3\n10 1 26831529 26835614 2\n10 1 26835770 26835778 3\n10 1 26835821 26835966 2\n10 1 26940518 26940518 3\n10 1 26940560 26940568 2\n10 1 26940635 26940635 3\n10 1 26940639 26940834 2\n10 1 26940868 26940903 3\n10 1 26940988 26940988 2\n10 1 26940993 26941053 3\n10 1 26943974 26944084 2\n10 1 26944099 26974118 3\n10 1 26979175 27147101 2\n10 1 27147225 27147225 3\n10 1 27147276 27147276 2\n10 1 27147309 27590345 3\n10 1 27590373 28901989 4\n10 1 28902000 28902191 2\n10 1 28950782 28952959 4\n10 1 28954722 28958646 2\n10 1 28958649 28958657 4\n10 1 28967204 29008054 2\n10 1 29008075 29008084 4\n10 1 29008087 29008087 2\n10 1 29011464 29011464 4\n10 1 29011533 29011610 2\n10 1 29018166 29018428 4\n10 1 29019567 29390210 2\n10 1 29390471 29483754 4\n10 1 29483772 29483948 2\n10 1 29484035 30291789 4\n10 1 30291797 30551476 2\n10 1 30551479 31756193 4\n10 1 31756271 31764854 2\n10 1 31774059 31827631 4\n10 1 31827647 31828234 2\n10 1 31828237 31838833 4\n10 1 31838836 31867737 2\n10 1 31867746 31867857 4\n10 1 31867875 31967240 2\n10 1 31967248 32100238 4\n10 1 32107261 34611322 2\n10 1 34611380 36095987 3\n10 1 36096035 36179262 2\n10 1 36179298 36199488 3\n10 1 36200899 36591205 2\n10 1 36591263 37087961 1\n10 1 37089021 37674811 2\n11 1 1 793676 2\n11 1 793780 793780 1\n11 1 793812 793812 2\n11 1 793985 795249 1\n11 1 795342 834008 2\n11 1 849463 1153622 1\n11 1 1153632 1477988 2\n11 1 1479037 1525922 1\n11 1 1525928 3549512 2\n11 1 3549728 3582554 1\n11 1 3582784 3584285 2\n11 1 3584306 3584577 1\n11 1 3584607 3584607 2\n11 1 3584886 3596615 1\n11 1 3597746 3598099 2\n11 1 3598355 4149263 1\n11 1 4151701 4151741 2\n11 1 4151896 5154398 1\n11 1 5154440 5176052 2\n11 1 5176355 5177356 1\n11 1 5177368 6029790 2\n11 1 6030001 6030022 1\n11 1 6058850 6242936 2\n11 1 6242965 6251620 1\n11 1 6251640 6251671 2\n11 1 6251692 6319317 1\n11 1 6319919 6319919 2\n11 1 6319936 6319936 1\n11 1 6319956 9710463 2\n11 1 9713454 9713454 1\n11 1 9713535 9713707 2\n11 1 9722525 14808147 1\n11 1 14808379 16473529 2\n11 1 16473667 16473720 1\n11 1 16473801 16473818 2\n11 1 16473829 16473829 1\n11 1 16479187 16479187 2\n11 1 16479216 18232083 1\n11 1 18232099 18790496 2\n11 1 18790579 18866466 1\n11 1 18866696 18866696 2\n11 1 18866756 18974613 1\n11 1 18991864 18992199 2\n11 1 18994114 19057224 1\n11 1 19057237 19087652 2\n11 1 19090066 19090066 1\n11 1 19090329 19115483 2\n11 1 19117319 20305614 1\n11 1 20327765 20648726 2\n11 1 20649904 20649904 1\n11 1 20649919 21726798 2\n11 1 21771204 21771204 1\n11 1 21771259 21771657 2\n11 1 21771693 21879280 1\n11 1 21879349 21879356 2\n11 1 21879492 21920409 1\n11 1 21920456 21930340 2\n11 1 21941829 22025593 1\n11 1 22025629 22028832 2\n11 1 22028876 22028876 1\n11 1 22030962 22299224 2\n11 1 22301313 22301313 1\n11 1 22301950 22549120 2\n11 1 22549153 22549153 3\n11 1 22549165 22549165 2\n11 1 22549782 23590142 3\n11 1 23593214 23593289 2\n11 1 23593307 23600591 3\n11 1 23609045 23740800 2\n11 1 23740820 24498493 4\n11 1 24498638 24631127 2\n11 1 24631157 25323198 3\n11 1 25323331 25751555 2\n11 1 25751559 25779152 4\n11 1 25779306 25785699 2\n11 1 25828410 25828587 4\n11 1 25828597 25887349 2\n11 1 25888460 25888463 4\n11 1 25888717 25921061 2\n11 1 25921299 25921299 4\n11 1 25935692 25935728 2\n11 1 25935765 27954350 4");
	load_ideogram();
}
function clear(){
	var element = document.getElementById("_ideogram");
	if(element != null){
		element.parentNode.removeChild(element);
	}
}
function generateSVG(){
  //get svg element.
  var svg = document.getElementById("_ideogram");

  //get svg source.
  var serializer = new XMLSerializer();
  var source = serializer.serializeToString(svg);

  //add name spaces.
  if(!source.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)){
  	source = source.replace(/^<svg/, '<svg xmlns="http://www.w3.org/2000/svg"');
  }
  if(!source.match(/^<svg[^>]+"http\:\/\/www\.w3\.org\/1999\/xlink"/)){
  	source = source.replace(/^<svg/, '<svg xmlns:xlink="http://www.w3.org/1999/xlink"');
  }

  //add xml declaration
  source = '<?xml version="1.0" standalone="no"?>\r\n' + source;

  //convert svg source to URI data scheme.
  var url = "data:image/svg+xml;charset=utf-8,"+encodeURIComponent(source);

  //set url value to a element's href attribute.
  document.getElementById("download").href = url
  document.getElementById("download").download = "result.svg";
  document.getElementById("download").click();
}
function displaytext(value){
	var letters = document.getElementsByClassName("chrLabel");
	for (i = 0; i < letters.length; i++) { 
		letters[i].style.display=value;
	}
}
function colorchange(){
	for(var key in config.ancestors){
		if($("#selectorpreset :selected").val() == "preset1"){
			config.ancestors[key] = preset1[key];
		}else if ($("#selectorpreset :selected").val() == "preset2"){
			config.ancestors[key] = preset2[key];
		}else{
			config.ancestors[key] = preset3[key];
		}  
	}
	if($("#selectorpreset :selected").val() == "preset1"){
		for(var i = 0; i<config.rangeSet.length; i++){
			config.rangeSet[i].color = preset1.ploidy;
		}
	}else if ($("#selectorpreset :selected").val() == "preset2"){
		for(var i = 0; i<config.rangeSet.length; i++){
			config.rangeSet[i].color = preset2.ploidy;
		}
	}else{
		for(var i = 0; i<config.rangeSet.length; i++){
			config.rangeSet[i].color = preset3.ploidy;
		}
	} 
	load_ideogram();
}